'use strict';

require('commander');
require('chalk');
var index = require('./index-efc4b836.js');
require('fs-extra');
require('path');
require('inquirer');
require('handlebars');
require('recursive-readdir');
require('diff');
var read = require('./read-de0d3f6f.js');

const fileHandlers = [
  {
    patterns: ["packages/app/package.json"],
    handler: read.handlers.appPackageJson
  },
  {
    patterns: [/tsconfig\.json$/],
    handler: read.handlers.exactMatch
  },
  {
    patterns: [
      /README\.md$/,
      /\.eslintrc\.js$/,
      /^packages\/app\/(src|dev)\/[^/]+$/
    ],
    handler: read.handlers.exists
  },
  {
    patterns: [
      "lerna.json",
      /^src\//,
      /^patches\//,
      /^packages\/app\/public\//,
      /^packages\/app\/cypress/,
      /^plugins/,
      /package\.json$/
    ],
    handler: read.handlers.skip
  }
];
var diff = async (cmd) => {
  let promptFunc = read.inquirerPromptFunc;
  let finalize = () => {
  };
  if (cmd.check) {
    [promptFunc, finalize] = read.makeCheckPromptFunc();
  } else if (cmd.yes) {
    promptFunc = read.yesPromptFunc;
  }
  const templateFiles = await read.diffTemplateFiles("default-app", {version: index.version});
  await read.handleAllFiles(fileHandlers, templateFiles, promptFunc);
  await finalize();
};

exports.default = diff;
